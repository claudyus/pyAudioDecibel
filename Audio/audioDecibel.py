# -*- coding: utf-8 -*- 

import wx
import wx.xrc
import pyaudio
import wave
import scipy.io.wavfile as wavfile
import numpy as np
#import pylab as pl
import time
import datetime
import sqlite3
import threading
import sys
import os
###########################################################################
## Class Decibel
###########################################################################

class Decibel ( wx.Frame ):

    ###############
    def CurrentTime(self):
        st = datetime.datetime.fromtimestamp(time.time()).strftime('%Y-%m-%d %H:%M:%S')
        return st

    def InputDevices(self):
        dev = []
        p = pyaudio.PyAudio()
        info = p.get_host_api_info_by_index(0)
        numdevices = info.get('deviceCount')
        #for each audio device, determine if is an input or an output and add it to the appropriate list and dictionary
        for i in range (0,numdevices):
                if p.get_device_info_by_host_api_device_index(0,i).get('maxInputChannels')>0:
                        print "Input Device id ", i, " - ", p.get_device_info_by_host_api_device_index(0,i).get('name')
                        dev.append(p.get_device_info_by_host_api_device_index(0,i).get('name'))
        return dev
    def RecordSound(self,id,fl):
        CHUNK = 2048
        FORMAT = pyaudio.paInt16
        CHANNELS = 2
        RATE = 44100
        RECORD_SECONDS = 1
        WAVE_OUTPUT_FILENAME = fl

        p = pyaudio.PyAudio()

        stream = p.open(format=FORMAT,
                        channels=CHANNELS,
                        rate=RATE,
                        input=True,
                        frames_per_buffer=CHUNK,
                        input_device_index=id)

        print("* recording")

        frames = []

        for i in range(0, int(RATE / CHUNK * RECORD_SECONDS)):
            data = stream.read(CHUNK)
            frames.append(data)

        print("* done recording")

        stream.stop_stream()
        stream.close()
        p.terminate()

        wf = wave.open(WAVE_OUTPUT_FILENAME, 'wb')
        wf.setnchannels(CHANNELS)
        wf.setsampwidth(p.get_sample_size(FORMAT))
        wf.setframerate(RATE)
        wf.writeframes(b''.join(frames))
        wf.close()

    def CalculateDecibel(self,fl):
        rate, data = wavfile.read(fl)

        p = 20*np.log10(np.abs(np.fft.rfft(data[:2048, 0])))
        f = np.linspace(0, 500,  500)
        #f = np.fft.fftfreq(len(np.abs(np.fft.fft(data[:2048, 0]))))
        #f = np.fft.fftfreq(500,1)

        #print abs(p).min(),abs(p).max()
        #print tuple(p)
        #print(abs(f * rate).min(), abs(f * rate).max())
        #print type(p),type(f)
      


        
            
        #print p
        #print max(f),len(f)
        return tuple(p)

    def LogDecibel(self,id):
        p = pyaudio.PyAudio()
        conn = sqlite3.connect('log.sqlite3',20)
        conn.isolation_level = 'EXCLUSIVE'
        conn.execute('BEGIN EXCLUSIVE')
        cur = conn.cursor()
        fl = 'fl' +str(id)+'.wav'
        x = self.CalculateDecibel(fl)
        print type(x)

        val = (1,self.CurrentTime(),p.get_device_info_by_index(id)['name'],) + x
        cur.execute('''CREATE TABLE IF NOT EXISTS LOG_DECIBEL_VALUE_'''+ str(id)+ ''' ( 	`LOG_ID`	INTEGER PRIMARY KEY AUTOINCREMENT, 	`LOG_TIMESTAMP`	TEXT, 	`INPUT_DEVICE`	TEXT, 	`DECIBEL_VALUE_1_HZ`	TEXT, 	`DECIBEL_VALUE_2_HZ`	TEXT, 	`DECIBEL_VALUE_3_HZ`	TEXT, 	`DECIBEL_VALUE_4_HZ`	TEXT, 	`DECIBEL_VALUE_5_HZ`	TEXT, 	`DECIBEL_VALUE_6_HZ`	TEXT, 	`DECIBEL_VALUE_7_HZ`	TEXT, 	`DECIBEL_VALUE_8_HZ`	TEXT, 	`DECIBEL_VALUE_9_HZ`	TEXT, 	`DECIBEL_VALUE_10_HZ`	TEXT, 	`DECIBEL_VALUE_11_HZ`	TEXT, 	`DECIBEL_VALUE_12_HZ`	TEXT, 	`DECIBEL_VALUE_13_HZ`	TEXT, 	`DECIBEL_VALUE_14_HZ`	TEXT, 	`DECIBEL_VALUE_15_HZ`	TEXT, 	`DECIBEL_VALUE_16_HZ`	TEXT, 	`DECIBEL_VALUE_17_HZ`	TEXT, 	`DECIBEL_VALUE_18_HZ`	TEXT, 	`DECIBEL_VALUE_19_HZ`	TEXT, 	`DECIBEL_VALUE_20_HZ`	TEXT, 	`DECIBEL_VALUE_21_HZ`	TEXT, 	`DECIBEL_VALUE_22_HZ`	TEXT, 	`DECIBEL_VALUE_23_HZ`	TEXT, 	`DECIBEL_VALUE_24_HZ`	TEXT, 	`DECIBEL_VALUE_25_HZ`	TEXT, 	`DECIBEL_VALUE_26_HZ`	TEXT, 	`DECIBEL_VALUE_27_HZ`	TEXT, 	`DECIBEL_VALUE_28_HZ`	TEXT, 	`DECIBEL_VALUE_29_HZ`	TEXT, 	`DECIBEL_VALUE_30_HZ`	TEXT, 	`DECIBEL_VALUE_31_HZ`	TEXT, 	`DECIBEL_VALUE_32_HZ`	TEXT, 	`DECIBEL_VALUE_33_HZ`	TEXT, 	`DECIBEL_VALUE_34_HZ`	TEXT, 	`DECIBEL_VALUE_35_HZ`	TEXT, 	`DECIBEL_VALUE_36_HZ`	TEXT, 	`DECIBEL_VALUE_37_HZ`	TEXT, 	`DECIBEL_VALUE_38_HZ`	TEXT, 	`DECIBEL_VALUE_39_HZ`	TEXT, 	`DECIBEL_VALUE_40_HZ`	TEXT, 	`DECIBEL_VALUE_41_HZ`	TEXT, 	`DECIBEL_VALUE_42_HZ`	TEXT, 	`DECIBEL_VALUE_43_HZ`	TEXT, 	`DECIBEL_VALUE_44_HZ`	TEXT, 	`DECIBEL_VALUE_45_HZ`	TEXT, 	`DECIBEL_VALUE_46_HZ`	TEXT, 	`DECIBEL_VALUE_47_HZ`	TEXT, 	`DECIBEL_VALUE_48_HZ`	TEXT, 	`DECIBEL_VALUE_49_HZ`	TEXT, 	`DECIBEL_VALUE_50_HZ`	TEXT, 	`DECIBEL_VALUE_51_HZ`	TEXT, 	`DECIBEL_VALUE_52_HZ`	TEXT, 	`DECIBEL_VALUE_53_HZ`	TEXT, 	`DECIBEL_VALUE_54_HZ`	TEXT, 	`DECIBEL_VALUE_55_HZ`	TEXT, 	`DECIBEL_VALUE_56_HZ`	TEXT, 	`DECIBEL_VALUE_57_HZ`	TEXT, 	`DECIBEL_VALUE_58_HZ`	TEXT, 	`DECIBEL_VALUE_59_HZ`	TEXT, 	`DECIBEL_VALUE_60_HZ`	TEXT, 	`DECIBEL_VALUE_61_HZ`	TEXT, 	`DECIBEL_VALUE_62_HZ`	TEXT, 	`DECIBEL_VALUE_63_HZ`	TEXT, 	`DECIBEL_VALUE_64_HZ`	TEXT, 	`DECIBEL_VALUE_65_HZ`	TEXT, 	`DECIBEL_VALUE_66_HZ`	TEXT, 	`DECIBEL_VALUE_67_HZ`	TEXT, 	`DECIBEL_VALUE_68_HZ`	TEXT, 	`DECIBEL_VALUE_69_HZ`	TEXT, 	`DECIBEL_VALUE_70_HZ`	TEXT, 	`DECIBEL_VALUE_71_HZ`	TEXT, 	`DECIBEL_VALUE_72_HZ`	TEXT, 	`DECIBEL_VALUE_73_HZ`	TEXT, 	`DECIBEL_VALUE_74_HZ`	TEXT, 	`DECIBEL_VALUE_75_HZ`	TEXT, 	`DECIBEL_VALUE_76_HZ`	TEXT, 	`DECIBEL_VALUE_77_HZ`	TEXT, 	`DECIBEL_VALUE_78_HZ`	TEXT, 	`DECIBEL_VALUE_79_HZ`	TEXT, 	`DECIBEL_VALUE_80_HZ`	TEXT, 	`DECIBEL_VALUE_81_HZ`	TEXT, 	`DECIBEL_VALUE_82_HZ`	TEXT, 	`DECIBEL_VALUE_83_HZ`	TEXT, 	`DECIBEL_VALUE_84_HZ`	TEXT, 	`DECIBEL_VALUE_85_HZ`	TEXT, 	`DECIBEL_VALUE_86_HZ`	TEXT, 	`DECIBEL_VALUE_87_HZ`	TEXT, 	`DECIBEL_VALUE_88_HZ`	TEXT, 	`DECIBEL_VALUE_89_HZ`	TEXT, 	`DECIBEL_VALUE_90_HZ`	TEXT, 	`DECIBEL_VALUE_91_HZ`	TEXT, 	`DECIBEL_VALUE_92_HZ`	TEXT, 	`DECIBEL_VALUE_93_HZ`	TEXT, 	`DECIBEL_VALUE_94_HZ`	TEXT, 	`DECIBEL_VALUE_95_HZ`	TEXT, 	`DECIBEL_VALUE_96_HZ`	TEXT, 	`DECIBEL_VALUE_97_HZ`	TEXT, 	`DECIBEL_VALUE_98_HZ`	TEXT, 	`DECIBEL_VALUE_99_HZ`	TEXT, 	`DECIBEL_VALUE_100_HZ`	TEXT, 	`DECIBEL_VALUE_101_HZ`	TEXT, 	`DECIBEL_VALUE_102_HZ`	TEXT, 	`DECIBEL_VALUE_103_HZ`	TEXT, 	`DECIBEL_VALUE_104_HZ`	TEXT, 	`DECIBEL_VALUE_105_HZ`	TEXT, 	`DECIBEL_VALUE_106_HZ`	TEXT, 	`DECIBEL_VALUE_107_HZ`	TEXT, 	`DECIBEL_VALUE_108_HZ`	TEXT, 	`DECIBEL_VALUE_109_HZ`	TEXT, 	`DECIBEL_VALUE_110_HZ`	TEXT, 	`DECIBEL_VALUE_111_HZ`	TEXT, 	`DECIBEL_VALUE_112_HZ`	TEXT, 	`DECIBEL_VALUE_113_HZ`	TEXT, 	`DECIBEL_VALUE_114_HZ`	TEXT, 	`DECIBEL_VALUE_115_HZ`	TEXT, 	`DECIBEL_VALUE_116_HZ`	TEXT, 	`DECIBEL_VALUE_117_HZ`	TEXT, 	`DECIBEL_VALUE_118_HZ`	TEXT, 	`DECIBEL_VALUE_119_HZ`	TEXT, 	`DECIBEL_VALUE_120_HZ`	TEXT, 	`DECIBEL_VALUE_121_HZ`	TEXT, 	`DECIBEL_VALUE_122_HZ`	TEXT, 	`DECIBEL_VALUE_123_HZ`	TEXT, 	`DECIBEL_VALUE_124_HZ`	TEXT, 	`DECIBEL_VALUE_125_HZ`	TEXT, 	`DECIBEL_VALUE_126_HZ`	TEXT, 	`DECIBEL_VALUE_127_HZ`	TEXT, 	`DECIBEL_VALUE_128_HZ`	TEXT, 	`DECIBEL_VALUE_129_HZ`	TEXT, 	`DECIBEL_VALUE_130_HZ`	TEXT, 	`DECIBEL_VALUE_131_HZ`	TEXT, 	`DECIBEL_VALUE_132_HZ`	TEXT, 	`DECIBEL_VALUE_133_HZ`	TEXT, 	`DECIBEL_VALUE_134_HZ`	TEXT, 	`DECIBEL_VALUE_135_HZ`	TEXT, 	`DECIBEL_VALUE_136_HZ`	TEXT, 	`DECIBEL_VALUE_137_HZ`	TEXT, 	`DECIBEL_VALUE_138_HZ`	TEXT, 	`DECIBEL_VALUE_139_HZ`	TEXT, 	`DECIBEL_VALUE_140_HZ`	TEXT, 	`DECIBEL_VALUE_141_HZ`	TEXT, 	`DECIBEL_VALUE_142_HZ`	TEXT, 	`DECIBEL_VALUE_143_HZ`	TEXT, 	`DECIBEL_VALUE_144_HZ`	TEXT, 	`DECIBEL_VALUE_145_HZ`	TEXT, 	`DECIBEL_VALUE_146_HZ`	TEXT, 	`DECIBEL_VALUE_147_HZ`	TEXT, 	`DECIBEL_VALUE_148_HZ`	TEXT, 	`DECIBEL_VALUE_149_HZ`	TEXT, 	`DECIBEL_VALUE_150_HZ`	TEXT, 	`DECIBEL_VALUE_151_HZ`	TEXT, 	`DECIBEL_VALUE_152_HZ`	TEXT, 	`DECIBEL_VALUE_153_HZ`	TEXT, 	`DECIBEL_VALUE_154_HZ`	TEXT, 	`DECIBEL_VALUE_155_HZ`	TEXT, 	`DECIBEL_VALUE_156_HZ`	TEXT, 	`DECIBEL_VALUE_157_HZ`	TEXT, 	`DECIBEL_VALUE_158_HZ`	TEXT, 	`DECIBEL_VALUE_159_HZ`	TEXT, 	`DECIBEL_VALUE_160_HZ`	TEXT, 	`DECIBEL_VALUE_161_HZ`	TEXT, 	`DECIBEL_VALUE_162_HZ`	TEXT, 	`DECIBEL_VALUE_163_HZ`	TEXT, 	`DECIBEL_VALUE_164_HZ`	TEXT, 	`DECIBEL_VALUE_165_HZ`	TEXT, 	`DECIBEL_VALUE_166_HZ`	TEXT, 	`DECIBEL_VALUE_167_HZ`	TEXT, 	`DECIBEL_VALUE_168_HZ`	TEXT, 	`DECIBEL_VALUE_169_HZ`	TEXT, 	`DECIBEL_VALUE_170_HZ`	TEXT, 	`DECIBEL_VALUE_171_HZ`	TEXT, 	`DECIBEL_VALUE_172_HZ`	TEXT, 	`DECIBEL_VALUE_173_HZ`	TEXT, 	`DECIBEL_VALUE_174_HZ`	TEXT, 	`DECIBEL_VALUE_175_HZ`	TEXT, 	`DECIBEL_VALUE_176_HZ`	TEXT, 	`DECIBEL_VALUE_177_HZ`	TEXT, 	`DECIBEL_VALUE_178_HZ`	TEXT, 	`DECIBEL_VALUE_179_HZ`	TEXT, 	`DECIBEL_VALUE_180_HZ`	TEXT, 	`DECIBEL_VALUE_181_HZ`	TEXT, 	`DECIBEL_VALUE_182_HZ`	TEXT, 	`DECIBEL_VALUE_183_HZ`	TEXT, 	`DECIBEL_VALUE_184_HZ`	TEXT, 	`DECIBEL_VALUE_185_HZ`	TEXT, 	`DECIBEL_VALUE_186_HZ`	TEXT, 	`DECIBEL_VALUE_187_HZ`	TEXT, 	`DECIBEL_VALUE_188_HZ`	TEXT, 	`DECIBEL_VALUE_189_HZ`	TEXT, 	`DECIBEL_VALUE_190_HZ`	TEXT, 	`DECIBEL_VALUE_191_HZ`	TEXT, 	`DECIBEL_VALUE_192_HZ`	TEXT, 	`DECIBEL_VALUE_193_HZ`	TEXT, 	`DECIBEL_VALUE_194_HZ`	TEXT, 	`DECIBEL_VALUE_195_HZ`	TEXT, 	`DECIBEL_VALUE_196_HZ`	TEXT, 	`DECIBEL_VALUE_197_HZ`	TEXT, 	`DECIBEL_VALUE_198_HZ`	TEXT, 	`DECIBEL_VALUE_199_HZ`	TEXT, 	`DECIBEL_VALUE_200_HZ`	TEXT, 	`DECIBEL_VALUE_201_HZ`	TEXT, 	`DECIBEL_VALUE_202_HZ`	TEXT, 	`DECIBEL_VALUE_203_HZ`	TEXT, 	`DECIBEL_VALUE_204_HZ`	TEXT, 	`DECIBEL_VALUE_205_HZ`	TEXT, 	`DECIBEL_VALUE_206_HZ`	TEXT, 	`DECIBEL_VALUE_207_HZ`	TEXT, 	`DECIBEL_VALUE_208_HZ`	TEXT, 	`DECIBEL_VALUE_209_HZ`	TEXT, 	`DECIBEL_VALUE_210_HZ`	TEXT, 	`DECIBEL_VALUE_211_HZ`	TEXT, 	`DECIBEL_VALUE_212_HZ`	TEXT, 	`DECIBEL_VALUE_213_HZ`	TEXT, 	`DECIBEL_VALUE_214_HZ`	TEXT, 	`DECIBEL_VALUE_215_HZ`	TEXT, 	`DECIBEL_VALUE_216_HZ`	TEXT, 	`DECIBEL_VALUE_217_HZ`	TEXT, 	`DECIBEL_VALUE_218_HZ`	TEXT, 	`DECIBEL_VALUE_219_HZ`	TEXT, 	`DECIBEL_VALUE_220_HZ`	TEXT, 	`DECIBEL_VALUE_221_HZ`	TEXT, 	`DECIBEL_VALUE_222_HZ`	TEXT, 	`DECIBEL_VALUE_223_HZ`	TEXT, 	`DECIBEL_VALUE_224_HZ`	TEXT, 	`DECIBEL_VALUE_225_HZ`	TEXT, 	`DECIBEL_VALUE_226_HZ`	TEXT, 	`DECIBEL_VALUE_227_HZ`	TEXT, 	`DECIBEL_VALUE_228_HZ`	TEXT, 	`DECIBEL_VALUE_229_HZ`	TEXT, 	`DECIBEL_VALUE_230_HZ`	TEXT, 	`DECIBEL_VALUE_231_HZ`	TEXT, 	`DECIBEL_VALUE_232_HZ`	TEXT, 	`DECIBEL_VALUE_233_HZ`	TEXT, 	`DECIBEL_VALUE_234_HZ`	TEXT, 	`DECIBEL_VALUE_235_HZ`	TEXT, 	`DECIBEL_VALUE_236_HZ`	TEXT, 	`DECIBEL_VALUE_237_HZ`	TEXT, 	`DECIBEL_VALUE_238_HZ`	TEXT, 	`DECIBEL_VALUE_239_HZ`	TEXT, 	`DECIBEL_VALUE_240_HZ`	TEXT, 	`DECIBEL_VALUE_241_HZ`	TEXT, 	`DECIBEL_VALUE_242_HZ`	TEXT, 	`DECIBEL_VALUE_243_HZ`	TEXT, 	`DECIBEL_VALUE_244_HZ`	TEXT, 	`DECIBEL_VALUE_245_HZ`	TEXT, 	`DECIBEL_VALUE_246_HZ`	TEXT, 	`DECIBEL_VALUE_247_HZ`	TEXT, 	`DECIBEL_VALUE_248_HZ`	TEXT, 	`DECIBEL_VALUE_249_HZ`	TEXT, 	`DECIBEL_VALUE_250_HZ`	TEXT, 	`DECIBEL_VALUE_251_HZ`	TEXT, 	`DECIBEL_VALUE_252_HZ`	TEXT, 	`DECIBEL_VALUE_253_HZ`	TEXT, 	`DECIBEL_VALUE_254_HZ`	TEXT, 	`DECIBEL_VALUE_255_HZ`	TEXT, 	`DECIBEL_VALUE_256_HZ`	TEXT, 	`DECIBEL_VALUE_257_HZ`	TEXT, 	`DECIBEL_VALUE_258_HZ`	TEXT, 	`DECIBEL_VALUE_259_HZ`	TEXT, 	`DECIBEL_VALUE_260_HZ`	TEXT, 	`DECIBEL_VALUE_261_HZ`	TEXT, 	`DECIBEL_VALUE_262_HZ`	TEXT, 	`DECIBEL_VALUE_263_HZ`	TEXT, 	`DECIBEL_VALUE_264_HZ`	TEXT, 	`DECIBEL_VALUE_265_HZ`	TEXT, 	`DECIBEL_VALUE_266_HZ`	TEXT, 	`DECIBEL_VALUE_267_HZ`	TEXT, 	`DECIBEL_VALUE_268_HZ`	TEXT, 	`DECIBEL_VALUE_269_HZ`	TEXT, 	`DECIBEL_VALUE_270_HZ`	TEXT, 	`DECIBEL_VALUE_271_HZ`	TEXT, 	`DECIBEL_VALUE_272_HZ`	TEXT, 	`DECIBEL_VALUE_273_HZ`	TEXT, 	`DECIBEL_VALUE_274_HZ`	TEXT, 	`DECIBEL_VALUE_275_HZ`	TEXT, 	`DECIBEL_VALUE_276_HZ`	TEXT, 	`DECIBEL_VALUE_277_HZ`	TEXT, 	`DECIBEL_VALUE_278_HZ`	TEXT, 	`DECIBEL_VALUE_279_HZ`	TEXT, 	`DECIBEL_VALUE_280_HZ`	TEXT, 	`DECIBEL_VALUE_281_HZ`	TEXT, 	`DECIBEL_VALUE_282_HZ`	TEXT, 	`DECIBEL_VALUE_283_HZ`	TEXT, 	`DECIBEL_VALUE_284_HZ`	TEXT, 	`DECIBEL_VALUE_285_HZ`	TEXT, 	`DECIBEL_VALUE_286_HZ`	TEXT, 	`DECIBEL_VALUE_287_HZ`	TEXT, 	`DECIBEL_VALUE_288_HZ`	TEXT, 	`DECIBEL_VALUE_289_HZ`	TEXT, 	`DECIBEL_VALUE_290_HZ`	TEXT, 	`DECIBEL_VALUE_291_HZ`	TEXT, 	`DECIBEL_VALUE_292_HZ`	TEXT, 	`DECIBEL_VALUE_293_HZ`	TEXT, 	`DECIBEL_VALUE_294_HZ`	TEXT, 	`DECIBEL_VALUE_295_HZ`	TEXT, 	`DECIBEL_VALUE_296_HZ`	TEXT, 	`DECIBEL_VALUE_297_HZ`	TEXT, 	`DECIBEL_VALUE_298_HZ`	TEXT, 	`DECIBEL_VALUE_299_HZ`	TEXT, 	`DECIBEL_VALUE_300_HZ`	TEXT, 	`DECIBEL_VALUE_301_HZ`	TEXT, 	`DECIBEL_VALUE_302_HZ`	TEXT, 	`DECIBEL_VALUE_303_HZ`	TEXT, 	`DECIBEL_VALUE_304_HZ`	TEXT, 	`DECIBEL_VALUE_305_HZ`	TEXT, 	`DECIBEL_VALUE_306_HZ`	TEXT, 	`DECIBEL_VALUE_307_HZ`	TEXT, 	`DECIBEL_VALUE_308_HZ`	TEXT, 	`DECIBEL_VALUE_309_HZ`	TEXT, 	`DECIBEL_VALUE_310_HZ`	TEXT, 	`DECIBEL_VALUE_311_HZ`	TEXT, 	`DECIBEL_VALUE_312_HZ`	TEXT, 	`DECIBEL_VALUE_313_HZ`	TEXT, 	`DECIBEL_VALUE_314_HZ`	TEXT, 	`DECIBEL_VALUE_315_HZ`	TEXT, 	`DECIBEL_VALUE_316_HZ`	TEXT, 	`DECIBEL_VALUE_317_HZ`	TEXT, 	`DECIBEL_VALUE_318_HZ`	TEXT, 	`DECIBEL_VALUE_319_HZ`	TEXT, 	`DECIBEL_VALUE_320_HZ`	TEXT, 	`DECIBEL_VALUE_321_HZ`	TEXT, 	`DECIBEL_VALUE_322_HZ`	TEXT, 	`DECIBEL_VALUE_323_HZ`	TEXT, 	`DECIBEL_VALUE_324_HZ`	TEXT, 	`DECIBEL_VALUE_325_HZ`	TEXT, 	`DECIBEL_VALUE_326_HZ`	TEXT, 	`DECIBEL_VALUE_327_HZ`	TEXT, 	`DECIBEL_VALUE_328_HZ`	TEXT, 	`DECIBEL_VALUE_329_HZ`	TEXT, 	`DECIBEL_VALUE_330_HZ`	TEXT, 	`DECIBEL_VALUE_331_HZ`	TEXT, 	`DECIBEL_VALUE_332_HZ`	TEXT, 	`DECIBEL_VALUE_333_HZ`	TEXT, 	`DECIBEL_VALUE_334_HZ`	TEXT, 	`DECIBEL_VALUE_335_HZ`	TEXT, 	`DECIBEL_VALUE_336_HZ`	TEXT, 	`DECIBEL_VALUE_337_HZ`	TEXT, 	`DECIBEL_VALUE_338_HZ`	TEXT, 	`DECIBEL_VALUE_339_HZ`	TEXT, 	`DECIBEL_VALUE_340_HZ`	TEXT, 	`DECIBEL_VALUE_341_HZ`	TEXT, 	`DECIBEL_VALUE_342_HZ`	TEXT, 	`DECIBEL_VALUE_343_HZ`	TEXT, 	`DECIBEL_VALUE_344_HZ`	TEXT, 	`DECIBEL_VALUE_345_HZ`	TEXT, 	`DECIBEL_VALUE_346_HZ`	TEXT, 	`DECIBEL_VALUE_347_HZ`	TEXT, 	`DECIBEL_VALUE_348_HZ`	TEXT, 	`DECIBEL_VALUE_349_HZ`	TEXT, 	`DECIBEL_VALUE_350_HZ`	TEXT, 	`DECIBEL_VALUE_351_HZ`	TEXT, 	`DECIBEL_VALUE_352_HZ`	TEXT, 	`DECIBEL_VALUE_353_HZ`	TEXT, 	`DECIBEL_VALUE_354_HZ`	TEXT, 	`DECIBEL_VALUE_355_HZ`	TEXT, 	`DECIBEL_VALUE_356_HZ`	TEXT, 	`DECIBEL_VALUE_357_HZ`	TEXT, 	`DECIBEL_VALUE_358_HZ`	TEXT, 	`DECIBEL_VALUE_359_HZ`	TEXT, 	`DECIBEL_VALUE_360_HZ`	TEXT, 	`DECIBEL_VALUE_361_HZ`	TEXT, 	`DECIBEL_VALUE_362_HZ`	TEXT, 	`DECIBEL_VALUE_363_HZ`	TEXT, 	`DECIBEL_VALUE_364_HZ`	TEXT, 	`DECIBEL_VALUE_365_HZ`	TEXT, 	`DECIBEL_VALUE_366_HZ`	TEXT, 	`DECIBEL_VALUE_367_HZ`	TEXT, 	`DECIBEL_VALUE_368_HZ`	TEXT, 	`DECIBEL_VALUE_369_HZ`	TEXT, 	`DECIBEL_VALUE_370_HZ`	TEXT, 	`DECIBEL_VALUE_371_HZ`	TEXT, 	`DECIBEL_VALUE_372_HZ`	TEXT, 	`DECIBEL_VALUE_373_HZ`	TEXT, 	`DECIBEL_VALUE_374_HZ`	TEXT, 	`DECIBEL_VALUE_375_HZ`	TEXT, 	`DECIBEL_VALUE_376_HZ`	TEXT, 	`DECIBEL_VALUE_377_HZ`	TEXT, 	`DECIBEL_VALUE_378_HZ`	TEXT, 	`DECIBEL_VALUE_379_HZ`	TEXT, 	`DECIBEL_VALUE_380_HZ`	TEXT, 	`DECIBEL_VALUE_381_HZ`	TEXT, 	`DECIBEL_VALUE_382_HZ`	TEXT, 	`DECIBEL_VALUE_383_HZ`	TEXT, 	`DECIBEL_VALUE_384_HZ`	TEXT, 	`DECIBEL_VALUE_385_HZ`	TEXT, 	`DECIBEL_VALUE_386_HZ`	TEXT, 	`DECIBEL_VALUE_387_HZ`	TEXT, 	`DECIBEL_VALUE_388_HZ`	TEXT, 	`DECIBEL_VALUE_389_HZ`	TEXT, 	`DECIBEL_VALUE_390_HZ`	TEXT, 	`DECIBEL_VALUE_391_HZ`	TEXT, 	`DECIBEL_VALUE_392_HZ`	TEXT, 	`DECIBEL_VALUE_393_HZ`	TEXT, 	`DECIBEL_VALUE_394_HZ`	TEXT, 	`DECIBEL_VALUE_395_HZ`	TEXT, 	`DECIBEL_VALUE_396_HZ`	TEXT, 	`DECIBEL_VALUE_397_HZ`	TEXT, 	`DECIBEL_VALUE_398_HZ`	TEXT, 	`DECIBEL_VALUE_399_HZ`	TEXT, 	`DECIBEL_VALUE_400_HZ`	TEXT, 	`DECIBEL_VALUE_401_HZ`	TEXT, 	`DECIBEL_VALUE_402_HZ`	TEXT, 	`DECIBEL_VALUE_403_HZ`	TEXT, 	`DECIBEL_VALUE_404_HZ`	TEXT, 	`DECIBEL_VALUE_405_HZ`	TEXT, 	`DECIBEL_VALUE_406_HZ`	TEXT, 	`DECIBEL_VALUE_407_HZ`	TEXT, 	`DECIBEL_VALUE_408_HZ`	TEXT, 	`DECIBEL_VALUE_409_HZ`	TEXT, 	`DECIBEL_VALUE_410_HZ`	TEXT, 	`DECIBEL_VALUE_411_HZ`	TEXT, 	`DECIBEL_VALUE_412_HZ`	TEXT, 	`DECIBEL_VALUE_413_HZ`	TEXT, 	`DECIBEL_VALUE_414_HZ`	TEXT, 	`DECIBEL_VALUE_415_HZ`	TEXT, 	`DECIBEL_VALUE_416_HZ`	TEXT, 	`DECIBEL_VALUE_417_HZ`	TEXT, 	`DECIBEL_VALUE_418_HZ`	TEXT, 	`DECIBEL_VALUE_419_HZ`	TEXT, 	`DECIBEL_VALUE_420_HZ`	TEXT, 	`DECIBEL_VALUE_421_HZ`	TEXT, 	`DECIBEL_VALUE_422_HZ`	TEXT, 	`DECIBEL_VALUE_423_HZ`	TEXT, 	`DECIBEL_VALUE_424_HZ`	TEXT, 	`DECIBEL_VALUE_425_HZ`	TEXT, 	`DECIBEL_VALUE_426_HZ`	TEXT, 	`DECIBEL_VALUE_427_HZ`	TEXT, 	`DECIBEL_VALUE_428_HZ`	TEXT, 	`DECIBEL_VALUE_429_HZ`	TEXT, 	`DECIBEL_VALUE_430_HZ`	TEXT, 	`DECIBEL_VALUE_431_HZ`	TEXT, 	`DECIBEL_VALUE_432_HZ`	TEXT, 	`DECIBEL_VALUE_433_HZ`	TEXT, 	`DECIBEL_VALUE_434_HZ`	TEXT, 	`DECIBEL_VALUE_435_HZ`	TEXT, 	`DECIBEL_VALUE_436_HZ`	TEXT, 	`DECIBEL_VALUE_437_HZ`	TEXT, 	`DECIBEL_VALUE_438_HZ`	TEXT, 	`DECIBEL_VALUE_439_HZ`	TEXT, 	`DECIBEL_VALUE_440_HZ`	TEXT, 	`DECIBEL_VALUE_441_HZ`	TEXT, 	`DECIBEL_VALUE_442_HZ`	TEXT, 	`DECIBEL_VALUE_443_HZ`	TEXT, 	`DECIBEL_VALUE_444_HZ`	TEXT, 	`DECIBEL_VALUE_445_HZ`	TEXT, 	`DECIBEL_VALUE_446_HZ`	TEXT, 	`DECIBEL_VALUE_447_HZ`	TEXT, 	`DECIBEL_VALUE_448_HZ`	TEXT, 	`DECIBEL_VALUE_449_HZ`	TEXT, 	`DECIBEL_VALUE_450_HZ`	TEXT, 	`DECIBEL_VALUE_451_HZ`	TEXT, 	`DECIBEL_VALUE_452_HZ`	TEXT, 	`DECIBEL_VALUE_453_HZ`	TEXT, 	`DECIBEL_VALUE_454_HZ`	TEXT, 	`DECIBEL_VALUE_455_HZ`	TEXT, 	`DECIBEL_VALUE_456_HZ`	TEXT, 	`DECIBEL_VALUE_457_HZ`	TEXT, 	`DECIBEL_VALUE_458_HZ`	TEXT, 	`DECIBEL_VALUE_459_HZ`	TEXT, 	`DECIBEL_VALUE_460_HZ`	TEXT, 	`DECIBEL_VALUE_461_HZ`	TEXT, 	`DECIBEL_VALUE_462_HZ`	TEXT, 	`DECIBEL_VALUE_463_HZ`	TEXT, 	`DECIBEL_VALUE_464_HZ`	TEXT, 	`DECIBEL_VALUE_465_HZ`	TEXT, 	`DECIBEL_VALUE_466_HZ`	TEXT, 	`DECIBEL_VALUE_467_HZ`	TEXT, 	`DECIBEL_VALUE_468_HZ`	TEXT, 	`DECIBEL_VALUE_469_HZ`	TEXT, 	`DECIBEL_VALUE_470_HZ`	TEXT, 	`DECIBEL_VALUE_471_HZ`	TEXT, 	`DECIBEL_VALUE_472_HZ`	TEXT, 	`DECIBEL_VALUE_473_HZ`	TEXT, 	`DECIBEL_VALUE_474_HZ`	TEXT, 	`DECIBEL_VALUE_475_HZ`	TEXT, 	`DECIBEL_VALUE_476_HZ`	TEXT, 	`DECIBEL_VALUE_477_HZ`	TEXT, 	`DECIBEL_VALUE_478_HZ`	TEXT, 	`DECIBEL_VALUE_479_HZ`	TEXT, 	`DECIBEL_VALUE_480_HZ`	TEXT, 	`DECIBEL_VALUE_481_HZ`	TEXT, 	`DECIBEL_VALUE_482_HZ`	TEXT, 	`DECIBEL_VALUE_483_HZ`	TEXT, 	`DECIBEL_VALUE_484_HZ`	TEXT, 	`DECIBEL_VALUE_485_HZ`	TEXT, 	`DECIBEL_VALUE_486_HZ`	TEXT, 	`DECIBEL_VALUE_487_HZ`	TEXT, 	`DECIBEL_VALUE_488_HZ`	TEXT, 	`DECIBEL_VALUE_489_HZ`	TEXT, 	`DECIBEL_VALUE_490_HZ`	TEXT, 	`DECIBEL_VALUE_491_HZ`	TEXT, 	`DECIBEL_VALUE_492_HZ`	TEXT, 	`DECIBEL_VALUE_493_HZ`	TEXT, 	`DECIBEL_VALUE_494_HZ`	TEXT, 	`DECIBEL_VALUE_495_HZ`	TEXT, 	`DECIBEL_VALUE_496_HZ`	TEXT, 	`DECIBEL_VALUE_497_HZ`	TEXT, 	`DECIBEL_VALUE_498_HZ`	TEXT, 	`DECIBEL_VALUE_499_HZ`	TEXT, 	`DECIBEL_VALUE_500_HZ`	TEXT 	 );''' )
            
        cur.execute("insert into LOG_DECIBEL_VALUE_" + str(id) + " (`LOG_TIMESTAMP`,	`INPUT_DEVICE`,	`DECIBEL_VALUE_1_HZ`,	`DECIBEL_VALUE_2_HZ`,	`DECIBEL_VALUE_3_HZ`,	`DECIBEL_VALUE_4_HZ`,	`DECIBEL_VALUE_5_HZ`,	`DECIBEL_VALUE_6_HZ`,	`DECIBEL_VALUE_7_HZ`,	`DECIBEL_VALUE_8_HZ`,	`DECIBEL_VALUE_9_HZ`,	`DECIBEL_VALUE_10_HZ`,	`DECIBEL_VALUE_11_HZ`,	`DECIBEL_VALUE_12_HZ`,	`DECIBEL_VALUE_13_HZ`,	`DECIBEL_VALUE_14_HZ`,	`DECIBEL_VALUE_15_HZ`,	`DECIBEL_VALUE_16_HZ`,	`DECIBEL_VALUE_17_HZ`,	`DECIBEL_VALUE_18_HZ`,	`DECIBEL_VALUE_19_HZ`,	`DECIBEL_VALUE_20_HZ`,	`DECIBEL_VALUE_21_HZ`,	`DECIBEL_VALUE_22_HZ`,	`DECIBEL_VALUE_23_HZ`,	`DECIBEL_VALUE_24_HZ`,	`DECIBEL_VALUE_25_HZ`,	`DECIBEL_VALUE_26_HZ`,	`DECIBEL_VALUE_27_HZ`,	`DECIBEL_VALUE_28_HZ`,	`DECIBEL_VALUE_29_HZ`,	`DECIBEL_VALUE_30_HZ`,	`DECIBEL_VALUE_31_HZ`,	`DECIBEL_VALUE_32_HZ`,	`DECIBEL_VALUE_33_HZ`,	`DECIBEL_VALUE_34_HZ`,	`DECIBEL_VALUE_35_HZ`,	`DECIBEL_VALUE_36_HZ`,	`DECIBEL_VALUE_37_HZ`,	`DECIBEL_VALUE_38_HZ`,	`DECIBEL_VALUE_39_HZ`,	`DECIBEL_VALUE_40_HZ`,	`DECIBEL_VALUE_41_HZ`,	`DECIBEL_VALUE_42_HZ`,	`DECIBEL_VALUE_43_HZ`,	`DECIBEL_VALUE_44_HZ`,	`DECIBEL_VALUE_45_HZ`,	`DECIBEL_VALUE_46_HZ`,	`DECIBEL_VALUE_47_HZ`,	`DECIBEL_VALUE_48_HZ`,	`DECIBEL_VALUE_49_HZ`,	`DECIBEL_VALUE_50_HZ`,	`DECIBEL_VALUE_51_HZ`,	`DECIBEL_VALUE_52_HZ`,	`DECIBEL_VALUE_53_HZ`,	`DECIBEL_VALUE_54_HZ`,	`DECIBEL_VALUE_55_HZ`,	`DECIBEL_VALUE_56_HZ`,	`DECIBEL_VALUE_57_HZ`,	`DECIBEL_VALUE_58_HZ`,	`DECIBEL_VALUE_59_HZ`,	`DECIBEL_VALUE_60_HZ`,	`DECIBEL_VALUE_61_HZ`,	`DECIBEL_VALUE_62_HZ`,	`DECIBEL_VALUE_63_HZ`,	`DECIBEL_VALUE_64_HZ`,	`DECIBEL_VALUE_65_HZ`,	`DECIBEL_VALUE_66_HZ`,	`DECIBEL_VALUE_67_HZ`,	`DECIBEL_VALUE_68_HZ`,	`DECIBEL_VALUE_69_HZ`,	`DECIBEL_VALUE_70_HZ`,	`DECIBEL_VALUE_71_HZ`,	`DECIBEL_VALUE_72_HZ`,	`DECIBEL_VALUE_73_HZ`,	`DECIBEL_VALUE_74_HZ`,	`DECIBEL_VALUE_75_HZ`,	`DECIBEL_VALUE_76_HZ`,	`DECIBEL_VALUE_77_HZ`,	`DECIBEL_VALUE_78_HZ`,	`DECIBEL_VALUE_79_HZ`,	`DECIBEL_VALUE_80_HZ`,	`DECIBEL_VALUE_81_HZ`,	`DECIBEL_VALUE_82_HZ`,	`DECIBEL_VALUE_83_HZ`,	`DECIBEL_VALUE_84_HZ`,	`DECIBEL_VALUE_85_HZ`,	`DECIBEL_VALUE_86_HZ`,	`DECIBEL_VALUE_87_HZ`,	`DECIBEL_VALUE_88_HZ`,	`DECIBEL_VALUE_89_HZ`,	`DECIBEL_VALUE_90_HZ`,	`DECIBEL_VALUE_91_HZ`,	`DECIBEL_VALUE_92_HZ`,	`DECIBEL_VALUE_93_HZ`,	`DECIBEL_VALUE_94_HZ`,	`DECIBEL_VALUE_95_HZ`,	`DECIBEL_VALUE_96_HZ`,	`DECIBEL_VALUE_97_HZ`,	`DECIBEL_VALUE_98_HZ`,	`DECIBEL_VALUE_99_HZ`,	`DECIBEL_VALUE_100_HZ`,	`DECIBEL_VALUE_101_HZ`,	`DECIBEL_VALUE_102_HZ`,	`DECIBEL_VALUE_103_HZ`,	`DECIBEL_VALUE_104_HZ`,	`DECIBEL_VALUE_105_HZ`,	`DECIBEL_VALUE_106_HZ`,	`DECIBEL_VALUE_107_HZ`,	`DECIBEL_VALUE_108_HZ`,	`DECIBEL_VALUE_109_HZ`,	`DECIBEL_VALUE_110_HZ`,	`DECIBEL_VALUE_111_HZ`,	`DECIBEL_VALUE_112_HZ`,	`DECIBEL_VALUE_113_HZ`,	`DECIBEL_VALUE_114_HZ`,	`DECIBEL_VALUE_115_HZ`,	`DECIBEL_VALUE_116_HZ`,	`DECIBEL_VALUE_117_HZ`,	`DECIBEL_VALUE_118_HZ`,	`DECIBEL_VALUE_119_HZ`,	`DECIBEL_VALUE_120_HZ`,	`DECIBEL_VALUE_121_HZ`,	`DECIBEL_VALUE_122_HZ`,	`DECIBEL_VALUE_123_HZ`,	`DECIBEL_VALUE_124_HZ`,	`DECIBEL_VALUE_125_HZ`,	`DECIBEL_VALUE_126_HZ`,	`DECIBEL_VALUE_127_HZ`,	`DECIBEL_VALUE_128_HZ`,	`DECIBEL_VALUE_129_HZ`,	`DECIBEL_VALUE_130_HZ`,	`DECIBEL_VALUE_131_HZ`,	`DECIBEL_VALUE_132_HZ`,	`DECIBEL_VALUE_133_HZ`,	`DECIBEL_VALUE_134_HZ`,	`DECIBEL_VALUE_135_HZ`,	`DECIBEL_VALUE_136_HZ`,	`DECIBEL_VALUE_137_HZ`,	`DECIBEL_VALUE_138_HZ`,	`DECIBEL_VALUE_139_HZ`,	`DECIBEL_VALUE_140_HZ`,	`DECIBEL_VALUE_141_HZ`,	`DECIBEL_VALUE_142_HZ`,	`DECIBEL_VALUE_143_HZ`,	`DECIBEL_VALUE_144_HZ`,	`DECIBEL_VALUE_145_HZ`,	`DECIBEL_VALUE_146_HZ`,	`DECIBEL_VALUE_147_HZ`,	`DECIBEL_VALUE_148_HZ`,	`DECIBEL_VALUE_149_HZ`,	`DECIBEL_VALUE_150_HZ`,	`DECIBEL_VALUE_151_HZ`,	`DECIBEL_VALUE_152_HZ`,	`DECIBEL_VALUE_153_HZ`,	`DECIBEL_VALUE_154_HZ`,	`DECIBEL_VALUE_155_HZ`,	`DECIBEL_VALUE_156_HZ`,	`DECIBEL_VALUE_157_HZ`,	`DECIBEL_VALUE_158_HZ`,	`DECIBEL_VALUE_159_HZ`,	`DECIBEL_VALUE_160_HZ`,	`DECIBEL_VALUE_161_HZ`,	`DECIBEL_VALUE_162_HZ`,	`DECIBEL_VALUE_163_HZ`,	`DECIBEL_VALUE_164_HZ`,	`DECIBEL_VALUE_165_HZ`,	`DECIBEL_VALUE_166_HZ`,	`DECIBEL_VALUE_167_HZ`,	`DECIBEL_VALUE_168_HZ`,	`DECIBEL_VALUE_169_HZ`,	`DECIBEL_VALUE_170_HZ`,	`DECIBEL_VALUE_171_HZ`,	`DECIBEL_VALUE_172_HZ`,	`DECIBEL_VALUE_173_HZ`,	`DECIBEL_VALUE_174_HZ`,	`DECIBEL_VALUE_175_HZ`,	`DECIBEL_VALUE_176_HZ`,	`DECIBEL_VALUE_177_HZ`,	`DECIBEL_VALUE_178_HZ`,	`DECIBEL_VALUE_179_HZ`,	`DECIBEL_VALUE_180_HZ`,	`DECIBEL_VALUE_181_HZ`,	`DECIBEL_VALUE_182_HZ`,	`DECIBEL_VALUE_183_HZ`,	`DECIBEL_VALUE_184_HZ`,	`DECIBEL_VALUE_185_HZ`,	`DECIBEL_VALUE_186_HZ`,	`DECIBEL_VALUE_187_HZ`,	`DECIBEL_VALUE_188_HZ`,	`DECIBEL_VALUE_189_HZ`,	`DECIBEL_VALUE_190_HZ`,	`DECIBEL_VALUE_191_HZ`,	`DECIBEL_VALUE_192_HZ`,	`DECIBEL_VALUE_193_HZ`,	`DECIBEL_VALUE_194_HZ`,	`DECIBEL_VALUE_195_HZ`,	`DECIBEL_VALUE_196_HZ`,	`DECIBEL_VALUE_197_HZ`,	`DECIBEL_VALUE_198_HZ`,	`DECIBEL_VALUE_199_HZ`,	`DECIBEL_VALUE_200_HZ`,	`DECIBEL_VALUE_201_HZ`,	`DECIBEL_VALUE_202_HZ`,	`DECIBEL_VALUE_203_HZ`,	`DECIBEL_VALUE_204_HZ`,	`DECIBEL_VALUE_205_HZ`,	`DECIBEL_VALUE_206_HZ`,	`DECIBEL_VALUE_207_HZ`,	`DECIBEL_VALUE_208_HZ`,	`DECIBEL_VALUE_209_HZ`,	`DECIBEL_VALUE_210_HZ`,	`DECIBEL_VALUE_211_HZ`,	`DECIBEL_VALUE_212_HZ`,	`DECIBEL_VALUE_213_HZ`,	`DECIBEL_VALUE_214_HZ`,	`DECIBEL_VALUE_215_HZ`,	`DECIBEL_VALUE_216_HZ`,	`DECIBEL_VALUE_217_HZ`,	`DECIBEL_VALUE_218_HZ`,	`DECIBEL_VALUE_219_HZ`,	`DECIBEL_VALUE_220_HZ`,	`DECIBEL_VALUE_221_HZ`,	`DECIBEL_VALUE_222_HZ`,	`DECIBEL_VALUE_223_HZ`,	`DECIBEL_VALUE_224_HZ`,	`DECIBEL_VALUE_225_HZ`,	`DECIBEL_VALUE_226_HZ`,	`DECIBEL_VALUE_227_HZ`,	`DECIBEL_VALUE_228_HZ`,	`DECIBEL_VALUE_229_HZ`,	`DECIBEL_VALUE_230_HZ`,	`DECIBEL_VALUE_231_HZ`,	`DECIBEL_VALUE_232_HZ`,	`DECIBEL_VALUE_233_HZ`,	`DECIBEL_VALUE_234_HZ`,	`DECIBEL_VALUE_235_HZ`,	`DECIBEL_VALUE_236_HZ`,	`DECIBEL_VALUE_237_HZ`,	`DECIBEL_VALUE_238_HZ`,	`DECIBEL_VALUE_239_HZ`,	`DECIBEL_VALUE_240_HZ`,	`DECIBEL_VALUE_241_HZ`,	`DECIBEL_VALUE_242_HZ`,	`DECIBEL_VALUE_243_HZ`,	`DECIBEL_VALUE_244_HZ`,	`DECIBEL_VALUE_245_HZ`,	`DECIBEL_VALUE_246_HZ`,	`DECIBEL_VALUE_247_HZ`,	`DECIBEL_VALUE_248_HZ`,	`DECIBEL_VALUE_249_HZ`,	`DECIBEL_VALUE_250_HZ`,	`DECIBEL_VALUE_251_HZ`,	`DECIBEL_VALUE_252_HZ`,	`DECIBEL_VALUE_253_HZ`,	`DECIBEL_VALUE_254_HZ`,	`DECIBEL_VALUE_255_HZ`,	`DECIBEL_VALUE_256_HZ`,	`DECIBEL_VALUE_257_HZ`,	`DECIBEL_VALUE_258_HZ`,	`DECIBEL_VALUE_259_HZ`,	`DECIBEL_VALUE_260_HZ`,	`DECIBEL_VALUE_261_HZ`,	`DECIBEL_VALUE_262_HZ`,	`DECIBEL_VALUE_263_HZ`,	`DECIBEL_VALUE_264_HZ`,	`DECIBEL_VALUE_265_HZ`,	`DECIBEL_VALUE_266_HZ`,	`DECIBEL_VALUE_267_HZ`,	`DECIBEL_VALUE_268_HZ`,	`DECIBEL_VALUE_269_HZ`,	`DECIBEL_VALUE_270_HZ`,	`DECIBEL_VALUE_271_HZ`,	`DECIBEL_VALUE_272_HZ`,	`DECIBEL_VALUE_273_HZ`,	`DECIBEL_VALUE_274_HZ`,	`DECIBEL_VALUE_275_HZ`,	`DECIBEL_VALUE_276_HZ`,	`DECIBEL_VALUE_277_HZ`,	`DECIBEL_VALUE_278_HZ`,	`DECIBEL_VALUE_279_HZ`,	`DECIBEL_VALUE_280_HZ`,	`DECIBEL_VALUE_281_HZ`,	`DECIBEL_VALUE_282_HZ`,	`DECIBEL_VALUE_283_HZ`,	`DECIBEL_VALUE_284_HZ`,	`DECIBEL_VALUE_285_HZ`,	`DECIBEL_VALUE_286_HZ`,	`DECIBEL_VALUE_287_HZ`,	`DECIBEL_VALUE_288_HZ`,	`DECIBEL_VALUE_289_HZ`,	`DECIBEL_VALUE_290_HZ`,	`DECIBEL_VALUE_291_HZ`,	`DECIBEL_VALUE_292_HZ`,	`DECIBEL_VALUE_293_HZ`,	`DECIBEL_VALUE_294_HZ`,	`DECIBEL_VALUE_295_HZ`,	`DECIBEL_VALUE_296_HZ`,	`DECIBEL_VALUE_297_HZ`,	`DECIBEL_VALUE_298_HZ`,	`DECIBEL_VALUE_299_HZ`,	`DECIBEL_VALUE_300_HZ`,	`DECIBEL_VALUE_301_HZ`,	`DECIBEL_VALUE_302_HZ`,	`DECIBEL_VALUE_303_HZ`,	`DECIBEL_VALUE_304_HZ`,	`DECIBEL_VALUE_305_HZ`,	`DECIBEL_VALUE_306_HZ`,	`DECIBEL_VALUE_307_HZ`,	`DECIBEL_VALUE_308_HZ`,	`DECIBEL_VALUE_309_HZ`,	`DECIBEL_VALUE_310_HZ`,	`DECIBEL_VALUE_311_HZ`,	`DECIBEL_VALUE_312_HZ`,	`DECIBEL_VALUE_313_HZ`,	`DECIBEL_VALUE_314_HZ`,	`DECIBEL_VALUE_315_HZ`,	`DECIBEL_VALUE_316_HZ`,	`DECIBEL_VALUE_317_HZ`,	`DECIBEL_VALUE_318_HZ`,	`DECIBEL_VALUE_319_HZ`,	`DECIBEL_VALUE_320_HZ`,	`DECIBEL_VALUE_321_HZ`,	`DECIBEL_VALUE_322_HZ`,	`DECIBEL_VALUE_323_HZ`,	`DECIBEL_VALUE_324_HZ`,	`DECIBEL_VALUE_325_HZ`,	`DECIBEL_VALUE_326_HZ`,	`DECIBEL_VALUE_327_HZ`,	`DECIBEL_VALUE_328_HZ`,	`DECIBEL_VALUE_329_HZ`,	`DECIBEL_VALUE_330_HZ`,	`DECIBEL_VALUE_331_HZ`,	`DECIBEL_VALUE_332_HZ`,	`DECIBEL_VALUE_333_HZ`,	`DECIBEL_VALUE_334_HZ`,	`DECIBEL_VALUE_335_HZ`,	`DECIBEL_VALUE_336_HZ`,	`DECIBEL_VALUE_337_HZ`,	`DECIBEL_VALUE_338_HZ`,	`DECIBEL_VALUE_339_HZ`,	`DECIBEL_VALUE_340_HZ`,	`DECIBEL_VALUE_341_HZ`,	`DECIBEL_VALUE_342_HZ`,	`DECIBEL_VALUE_343_HZ`,	`DECIBEL_VALUE_344_HZ`,	`DECIBEL_VALUE_345_HZ`,	`DECIBEL_VALUE_346_HZ`,	`DECIBEL_VALUE_347_HZ`,	`DECIBEL_VALUE_348_HZ`,	`DECIBEL_VALUE_349_HZ`,	`DECIBEL_VALUE_350_HZ`,	`DECIBEL_VALUE_351_HZ`,	`DECIBEL_VALUE_352_HZ`,	`DECIBEL_VALUE_353_HZ`,	`DECIBEL_VALUE_354_HZ`,	`DECIBEL_VALUE_355_HZ`,	`DECIBEL_VALUE_356_HZ`,	`DECIBEL_VALUE_357_HZ`,	`DECIBEL_VALUE_358_HZ`,	`DECIBEL_VALUE_359_HZ`,	`DECIBEL_VALUE_360_HZ`,	`DECIBEL_VALUE_361_HZ`,	`DECIBEL_VALUE_362_HZ`,	`DECIBEL_VALUE_363_HZ`,	`DECIBEL_VALUE_364_HZ`,	`DECIBEL_VALUE_365_HZ`,	`DECIBEL_VALUE_366_HZ`,	`DECIBEL_VALUE_367_HZ`,	`DECIBEL_VALUE_368_HZ`,	`DECIBEL_VALUE_369_HZ`,	`DECIBEL_VALUE_370_HZ`,	`DECIBEL_VALUE_371_HZ`,	`DECIBEL_VALUE_372_HZ`,	`DECIBEL_VALUE_373_HZ`,	`DECIBEL_VALUE_374_HZ`,	`DECIBEL_VALUE_375_HZ`,	`DECIBEL_VALUE_376_HZ`,	`DECIBEL_VALUE_377_HZ`,	`DECIBEL_VALUE_378_HZ`,	`DECIBEL_VALUE_379_HZ`,	`DECIBEL_VALUE_380_HZ`,	`DECIBEL_VALUE_381_HZ`,	`DECIBEL_VALUE_382_HZ`,	`DECIBEL_VALUE_383_HZ`,	`DECIBEL_VALUE_384_HZ`,	`DECIBEL_VALUE_385_HZ`,	`DECIBEL_VALUE_386_HZ`,	`DECIBEL_VALUE_387_HZ`,	`DECIBEL_VALUE_388_HZ`,	`DECIBEL_VALUE_389_HZ`,	`DECIBEL_VALUE_390_HZ`,	`DECIBEL_VALUE_391_HZ`,	`DECIBEL_VALUE_392_HZ`,	`DECIBEL_VALUE_393_HZ`,	`DECIBEL_VALUE_394_HZ`,	`DECIBEL_VALUE_395_HZ`,	`DECIBEL_VALUE_396_HZ`,	`DECIBEL_VALUE_397_HZ`,	`DECIBEL_VALUE_398_HZ`,	`DECIBEL_VALUE_399_HZ`,	`DECIBEL_VALUE_400_HZ`,	`DECIBEL_VALUE_401_HZ`,	`DECIBEL_VALUE_402_HZ`,	`DECIBEL_VALUE_403_HZ`,	`DECIBEL_VALUE_404_HZ`,	`DECIBEL_VALUE_405_HZ`,	`DECIBEL_VALUE_406_HZ`,	`DECIBEL_VALUE_407_HZ`,	`DECIBEL_VALUE_408_HZ`,	`DECIBEL_VALUE_409_HZ`,	`DECIBEL_VALUE_410_HZ`,	`DECIBEL_VALUE_411_HZ`,	`DECIBEL_VALUE_412_HZ`,	`DECIBEL_VALUE_413_HZ`,	`DECIBEL_VALUE_414_HZ`,	`DECIBEL_VALUE_415_HZ`,	`DECIBEL_VALUE_416_HZ`,	`DECIBEL_VALUE_417_HZ`,	`DECIBEL_VALUE_418_HZ`,	`DECIBEL_VALUE_419_HZ`,	`DECIBEL_VALUE_420_HZ`,	`DECIBEL_VALUE_421_HZ`,	`DECIBEL_VALUE_422_HZ`,	`DECIBEL_VALUE_423_HZ`,	`DECIBEL_VALUE_424_HZ`,	`DECIBEL_VALUE_425_HZ`,	`DECIBEL_VALUE_426_HZ`,	`DECIBEL_VALUE_427_HZ`,	`DECIBEL_VALUE_428_HZ`,	`DECIBEL_VALUE_429_HZ`,	`DECIBEL_VALUE_430_HZ`,	`DECIBEL_VALUE_431_HZ`,	`DECIBEL_VALUE_432_HZ`,	`DECIBEL_VALUE_433_HZ`,	`DECIBEL_VALUE_434_HZ`,	`DECIBEL_VALUE_435_HZ`,	`DECIBEL_VALUE_436_HZ`,	`DECIBEL_VALUE_437_HZ`,	`DECIBEL_VALUE_438_HZ`,	`DECIBEL_VALUE_439_HZ`,	`DECIBEL_VALUE_440_HZ`,	`DECIBEL_VALUE_441_HZ`,	`DECIBEL_VALUE_442_HZ`,	`DECIBEL_VALUE_443_HZ`,	`DECIBEL_VALUE_444_HZ`,	`DECIBEL_VALUE_445_HZ`,	`DECIBEL_VALUE_446_HZ`,	`DECIBEL_VALUE_447_HZ`,	`DECIBEL_VALUE_448_HZ`,	`DECIBEL_VALUE_449_HZ`,	`DECIBEL_VALUE_450_HZ`,	`DECIBEL_VALUE_451_HZ`,	`DECIBEL_VALUE_452_HZ`,	`DECIBEL_VALUE_453_HZ`,	`DECIBEL_VALUE_454_HZ`,	`DECIBEL_VALUE_455_HZ`,	`DECIBEL_VALUE_456_HZ`,	`DECIBEL_VALUE_457_HZ`,	`DECIBEL_VALUE_458_HZ`,	`DECIBEL_VALUE_459_HZ`,	`DECIBEL_VALUE_460_HZ`,	`DECIBEL_VALUE_461_HZ`,	`DECIBEL_VALUE_462_HZ`,	`DECIBEL_VALUE_463_HZ`,	`DECIBEL_VALUE_464_HZ`,	`DECIBEL_VALUE_465_HZ`,	`DECIBEL_VALUE_466_HZ`,	`DECIBEL_VALUE_467_HZ`,	`DECIBEL_VALUE_468_HZ`,	`DECIBEL_VALUE_469_HZ`,	`DECIBEL_VALUE_470_HZ`,	`DECIBEL_VALUE_471_HZ`,	`DECIBEL_VALUE_472_HZ`,	`DECIBEL_VALUE_473_HZ`,	`DECIBEL_VALUE_474_HZ`,	`DECIBEL_VALUE_475_HZ`,	`DECIBEL_VALUE_476_HZ`,	`DECIBEL_VALUE_477_HZ`,	`DECIBEL_VALUE_478_HZ`,	`DECIBEL_VALUE_479_HZ`,	`DECIBEL_VALUE_480_HZ`,	`DECIBEL_VALUE_481_HZ`,	`DECIBEL_VALUE_482_HZ`,	`DECIBEL_VALUE_483_HZ`,	`DECIBEL_VALUE_484_HZ`,	`DECIBEL_VALUE_485_HZ`,	`DECIBEL_VALUE_486_HZ`,	`DECIBEL_VALUE_487_HZ`,	`DECIBEL_VALUE_488_HZ`,	`DECIBEL_VALUE_489_HZ`,	`DECIBEL_VALUE_490_HZ`,	`DECIBEL_VALUE_491_HZ`,	`DECIBEL_VALUE_492_HZ`,	`DECIBEL_VALUE_493_HZ`,	`DECIBEL_VALUE_494_HZ`,	`DECIBEL_VALUE_495_HZ`,	`DECIBEL_VALUE_496_HZ`,	`DECIBEL_VALUE_497_HZ`,	`DECIBEL_VALUE_498_HZ`,	`DECIBEL_VALUE_499_HZ`,	`DECIBEL_VALUE_500_HZ`) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)", (self.CurrentTime(),p.get_device_info_by_index(id)['name'],x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],x[9],x[10],x[11],x[12],x[13],x[14],x[15],x[16],x[17],x[18],x[19],x[20],x[21],x[22],x[23],x[24],x[25],x[26],x[27],x[28],x[29],x[30],x[31],x[32],x[33],x[34],x[35],x[36],x[37],x[38],x[39],x[40],x[41],x[42],x[43],x[44],x[45],x[46],x[47],x[48],x[49],x[50],x[51],x[52],x[53],x[54],x[55],x[56],x[57],x[58],x[59],x[60],x[61],x[62],x[63],x[64],x[65],x[66],x[67],x[68],x[69],x[70],x[71],x[72],x[73],x[74],x[75],x[76],x[77],x[78],x[79],x[80],x[81],x[82],x[83],x[84],x[85],x[86],x[87],x[88],x[89],x[90],x[91],x[92],x[93],x[94],x[95],x[96],x[97],x[98],x[99],x[100],x[101],x[102],x[103],x[104],x[105],x[106],x[107],x[108],x[109],x[110],x[111],x[112],x[113],x[114],x[115],x[116],x[117],x[118],x[119],x[120],x[121],x[122],x[123],x[124],x[125],x[126],x[127],x[128],x[129],x[130],x[131],x[132],x[133],x[134],x[135],x[136],x[137],x[138],x[139],x[140],x[141],x[142],x[143],x[144],x[145],x[146],x[147],x[148],x[149],x[150],x[151],x[152],x[153],x[154],x[155],x[156],x[157],x[158],x[159],x[160],x[161],x[162],x[163],x[164],x[165],x[166],x[167],x[168],x[169],x[170],x[171],x[172],x[173],x[174],x[175],x[176],x[177],x[178],x[179],x[180],x[181],x[182],x[183],x[184],x[185],x[186],x[187],x[188],x[189],x[190],x[191],x[192],x[193],x[194],x[195],x[196],x[197],x[198],x[199],x[200],x[201],x[202],x[203],x[204],x[205],x[206],x[207],x[208],x[209],x[210],x[211],x[212],x[213],x[214],x[215],x[216],x[217],x[218],x[219],x[220],x[221],x[222],x[223],x[224],x[225],x[226],x[227],x[228],x[229],x[230],x[231],x[232],x[233],x[234],x[235],x[236],x[237],x[238],x[239],x[240],x[241],x[242],x[243],x[244],x[245],x[246],x[247],x[248],x[249],x[250],x[251],x[252],x[253],x[254],x[255],x[256],x[257],x[258],x[259],x[260],x[261],x[262],x[263],x[264],x[265],x[266],x[267],x[268],x[269],x[270],x[271],x[272],x[273],x[274],x[275],x[276],x[277],x[278],x[279],x[280],x[281],x[282],x[283],x[284],x[285],x[286],x[287],x[288],x[289],x[290],x[291],x[292],x[293],x[294],x[295],x[296],x[297],x[298],x[299],x[300],x[301],x[302],x[303],x[304],x[305],x[306],x[307],x[308],x[309],x[310],x[311],x[312],x[313],x[314],x[315],x[316],x[317],x[318],x[319],x[320],x[321],x[322],x[323],x[324],x[325],x[326],x[327],x[328],x[329],x[330],x[331],x[332],x[333],x[334],x[335],x[336],x[337],x[338],x[339],x[340],x[341],x[342],x[343],x[344],x[345],x[346],x[347],x[348],x[349],x[350],x[351],x[352],x[353],x[354],x[355],x[356],x[357],x[358],x[359],x[360],x[361],x[362],x[363],x[364],x[365],x[366],x[367],x[368],x[369],x[370],x[371],x[372],x[373],x[374],x[375],x[376],x[377],x[378],x[379],x[380],x[381],x[382],x[383],x[384],x[385],x[386],x[387],x[388],x[389],x[390],x[391],x[392],x[393],x[394],x[395],x[396],x[397],x[398],x[399],x[400],x[401],x[402],x[403],x[404],x[405],x[406],x[407],x[408],x[409],x[410],x[411],x[412],x[413],x[414],x[415],x[416],x[417],x[418],x[419],x[420],x[421],x[422],x[423],x[424],x[425],x[426],x[427],x[428],x[429],x[430],x[431],x[432],x[433],x[434],x[435],x[436],x[437],x[438],x[439],x[440],x[441],x[442],x[443],x[444],x[445],x[446],x[447],x[448],x[449],x[450],x[451],x[452],x[453],x[454],x[455],x[456],x[457],x[458],x[459],x[460],x[461],x[462],x[463],x[464],x[465],x[466],x[467],x[468],x[469],x[470],x[471],x[472],x[473],x[474],x[475],x[476],x[477],x[478],x[479],x[480],x[481],x[482],x[483],x[484],x[485],x[486],x[487],x[488],x[489],x[490],x[491],x[492],x[493],x[494],x[495],x[496],x[497],x[498],x[499],))
        conn.commit()
        conn.close()
    ###############

    def __init__( self, parent ):
        ##################
         
        wx.Frame.__init__ ( self, parent, id = wx.ID_ANY, title = u"Audio Intensity Recorder", pos = wx.DefaultPosition, size = wx.Size( 400,200 ), style = wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )

        self.SetSizeHintsSz( wx.Size( 400,225 ), wx.Size( 400,225 ) )
        self.SetForegroundColour( wx.Colour( 255, 128, 128 ) )
        self.SetBackgroundColour( wx.Colour( 0, 128, 128 ) )

        gbSizer2 = wx.GridBagSizer( 0, 0 )
        gbSizer2.SetFlexibleDirection( wx.BOTH )
        gbSizer2.SetNonFlexibleGrowMode( wx.FLEX_GROWMODE_SPECIFIED )

        self.m_button1 = wx.Button( self, wx.ID_ANY, u"Write", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_button1.SetBackgroundColour( wx.Colour( 0, 255, 0 ) )
        self.m_button1.SetToolTipString( u"Click to config logging" )

        gbSizer2.Add( self.m_button1, wx.GBPosition( 5, 2 ), wx.GBSpan( 1, 1 ), wx.ALL, 5 )

        self.m_button3 = wx.Button( self, wx.ID_ANY, u"Start", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_button3.SetBackgroundColour( wx.Colour( 0, 255, 0 ) )
        self.m_button3.SetToolTipString( u"Click to start logging" )

        gbSizer2.Add( self.m_button3, wx.GBPosition( 5, 3 ), wx.GBSpan( 1, 1 ), wx.ALL, 5 )

        self.m_button2 = wx.Button( self, wx.ID_ANY, u"Remove", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_button2.SetBackgroundColour( wx.Colour( 255, 128, 128 ) )
        self.m_button2.SetToolTipString( u"Click to remove the existing config" )

        gbSizer2.Add( self.m_button2, wx.GBPosition( 5, 4 ), wx.GBSpan( 1, 1 ), wx.ALL, 5 )
        self.m_button4 = wx.Button( self, wx.ID_ANY, u"Cancel", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_button4.SetBackgroundColour( wx.Colour( 255, 128, 128 ) )
        self.m_button4.SetToolTipString( u"Click to close the Appication" )

        gbSizer2.Add( self.m_button4, wx.GBPosition( 5, 5 ), wx.GBSpan( 1, 1 ), wx.ALL, 5 )

        self.m_staticText8 = wx.StaticText( self, wx.ID_ANY, u"Set Interval", wx.DefaultPosition, wx.DefaultSize, 0|wx.RAISED_BORDER )
        self.m_staticText8.Wrap( -1 )
        self.m_staticText8.SetForegroundColour( wx.Colour( 0, 0, 0 ) )
        self.m_staticText8.SetBackgroundColour( wx.Colour( 255, 255, 128 ) )
        
        gbSizer2.Add( self.m_staticText8, wx.GBPosition( 2, 2 ), wx.GBSpan( 1, 1 ), wx.ALL, 5 )

        self.m_staticText9 = wx.StaticText( self, wx.ID_ANY, u"Value", wx.DefaultPosition, wx.DefaultSize, 0|wx.RAISED_BORDER )
        self.m_staticText9.Wrap( -1 )
        self.m_staticText9.SetForegroundColour( wx.Colour( 0, 0, 0 ) )
        self.m_staticText9.SetBackgroundColour( wx.Colour( 255, 255, 128 ) )
        
        gbSizer2.Add( self.m_staticText9, wx.GBPosition( 2, 5 ), wx.GBSpan( 1, 2 ), wx.ALL, 5 )   

        m_choice1Choices = [ u"1", u"5", u"10", u"15", u"20", u"25", u"30", u"60", u"90" ]
        self.m_choice = wx.Choice( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, m_choice1Choices, 0 )
        self.m_choice.SetSelection( 4 )
        self.m_choice.SetForegroundColour( wx.Colour( 0, 0, 0 ) )
        self.m_choice.SetBackgroundColour( wx.Colour( 255, 255, 128 ) )

        gbSizer2.Add( self.m_choice, wx.GBPosition( 2, 4 ), wx.GBSpan( 1, 1 ), wx.ALL, 5 )

        self.m_staticText8 = wx.StaticText( self, wx.ID_ANY, u"Sound Card", wx.DefaultPosition, wx.DefaultSize, 0|wx.RAISED_BORDER )
        self.m_staticText8.Wrap( -1 )
        self.m_staticText8.SetForegroundColour( wx.Colour( 0, 0, 0 ) )
        self.m_staticText8.SetBackgroundColour( wx.Colour( 255, 255, 128 ) )
        
        gbSizer2.Add( self.m_staticText8, wx.GBPosition( 1, 2 ), wx.GBSpan( 1, 1 ), wx.ALL, 5 )        

        m_choice1Choices = [ u"Microsoft Sound Mapper", u"5", u"10", u"15", u"30" ]
        self.m_choice1 = wx.Choice( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, self.InputDevices(), 0 )
        self.m_choice1.SetSelection( 4 )
        self.m_choice1.SetForegroundColour( wx.Colour( 0, 0, 0 ) )
        self.m_choice1.SetBackgroundColour( wx.Colour( 255, 255, 128 ) )

        gbSizer2.Add( self.m_choice1, wx.GBPosition( 1, 4 ), wx.GBSpan( 1, 4 ), wx.ALL, 5 )

        self.SetSizer( gbSizer2 )
        self.Layout()
        self.SetSizer( gbSizer2 )
        self.Layout()
        menubar = wx.MenuBar()
        help = wx.Menu()
        help.Append(100, '&About')
        self.Bind(wx.EVT_MENU, self.OnAboutBox, id=100)
        help.Append(101, '&Configurations')
        
        self.Bind(wx.EVT_MENU, self.OnConfigCall, id=101)
        menubar.Append(help, '&Help')
        self.SetMenuBar(menubar)
        self.SetSize((300, 200))
        self.Centre()
        self.Show(True)

        self.Centre( wx.BOTH )
        # Connect Events
        self.m_button1.Bind( wx.EVT_BUTTON, self.writeConfig )
        self.m_button4.Bind( wx.EVT_BUTTON, self.onquit )
        self.m_button3.Bind( wx.EVT_BUTTON, self.generate )
        self.m_button2.Bind( wx.EVT_BUTTON, self.removeconfig )

        self.onstart()

        
    def removeconfig(self,event):
        os.remove("config.dat")
        self.m_button1.Enable()
        self.m_button3.Enable()
        

    def writeConfig(self,event):
        with open('config.dat','a') as f:
            
            f.write("%s %s\n" % (self.m_choice1.GetSelection(),self.m_choice.GetLabel()))
###############################
    def OnConfigCall(self, e):
        dialog = MyDialoge(wx.Dialog)
        result = dialog.ShowModal()
        
###############          

    def OnAboutBox(self, e):
        description = """App Info"""
        licence = """"""

        info = wx.AboutDialogInfo()

        #info.SetIcon(wx.Icon('hunter.png', wx.BITMAP_TYPE_PNG))
        info.SetName('Audio Intensity Recorder')
        info.SetVersion('1.0')
        info.SetDescription(description)
        info.SetCopyright('(C) Author')
        info.SetWebSite('email')
        info.SetLicence(licence)
        info.AddDeveloper('        Pratap548')
        info.AddDocWriter('        Pratap548')
        info.AddArtist('        Pratap548')
        info.AddTranslator('        Pratap548')


        wx.AboutBox(info)	


	
    def onquit(self,event):
        
        self.Close()
        
	
	
	# Virtual event handlers, overide them in your derived class
    def generate( self, event ):
        self.m_button1.Disable()
        self.m_button3.Disable()
        self.m_button2.Disable()
        def callback(id,slp):
            fl = 'fl' +id+'.wav'
            print fl
            while 1:
                
                self.RecordSound(int(id),fl)
                self.CalculateDecibel(fl)
                self.LogDecibel(int(id))
                time.sleep(int(slp) - 1)
                

        f = open('config.dat','r')
        for line in f:
            val = line.rstrip().split()
            t = threading.Thread(target=callback,args=(val[0],val[1]))
            
            t.start()
                
        f.close()
        
        def LogCount():
        

            while 1:
                conn = sqlite3.connect('log.sqlite3',20)
                
                cur = conn.cursor()            
                cur.execute("select sum(seq) from sqlite_sequence")
                v = cur.fetchone()
                self.m_staticText9.SetLabel(str(v[0]))
                
                time.sleep(2)
                self.m_staticText9.SetLabel('Running..')
                time.sleep(2)
                conn.close()
            ###############
        
        t = threading.Thread(target=LogCount)
        
        t.start()
        
    def onstart(self):
        if os.path.exists('config.dat'):
            self.m_button1.Disable()
            self.m_button3.Disable()
            self.m_button2.Disable()
            
            self.m_button1.Disable()
            self.m_button3.Disable()
            def callback(id,slp):
                fl = 'fl' +id+'.wav'
                print fl
                while 1:
                    
                    self.RecordSound(int(id),fl)
                    self.CalculateDecibel(fl)
                    self.LogDecibel(int(id))
                    time.sleep(int(slp))
                    

            f = open('config.dat','r')
            for line in f:
                val = line.rstrip().split()
                t = threading.Thread(target=callback,args=(val[0],val[1]))
                
                t.start()
                    
            f.close()
            def LogCount():
            

                while 1:
                    conn = sqlite3.connect('log.sqlite3',20)
                    
                    cur = conn.cursor()            
                    cur.execute("select sum(seq) from sqlite_sequence")
                    v = cur.fetchone()
                    self.m_staticText9.SetLabel(str(v[0]))
                    
                    time.sleep(2)
                    self.m_staticText9.SetLabel('Running..')
                    time.sleep(2)
                    conn.close()
                ###############
            #self.onstart()
            t = threading.Thread(target=LogCount)
            
            t.start()
            
        else:
            return 0

        
app = wx.App(False)
 
#create an object of CalcFrame
frame = Decibel(None)
#show the frame
frame.Show(True)
#start the applications
app.MainLoop()

